{% extends 'base.html' %}
{% block content %}
{% if success %}
<div class="message">
    <img class="icon" src="/img/success.png" />
    <h1>{{ confirmationMessage }}</h1>
</div>
{% if momentsUrl %}
<a class="twitter-moment" href="{{momentsUrl}}"></a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
{% else %}
<script type="text/javascript">
    setTimeout(function(){
        window.close();
    }, 4000)
</script>
{% endif %}
{% else %}
<img class="conversionLink" src="{{ conversionLink }}" width="1" height="1" />
<form class="validate" id="campaign" action="{{ action }}" method="POST">
    {% if errors %}
    <ul class="errors">
        {% for error in errors %}
        <li>{{ error }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if preview %}
        <input type="hidden" value="true" name="preview" />
        {#
            This will force the form to show the "success" state without
            adding extra logic to the backend
        #}
        <input type="hidden" value="true" name="success" />
        <input type="hidden" value="{{ confirmationMessage }}" name="confirmationMessage" />
        <input type="hidden" value="{{ momentUrl }}" name="momentUrl" />
    {% endif %}

    <div class="formSize campaignHeader">
        <img class="logo" src="https://twitter.com/{{ handle }}/profile_image?size=original" />
        <div class="field">
            <h2>{{ handleName }}</h2>
            <h3>@{{ handle }}</h3>
        </div>
        <div class="field">
            <p id="campaignName">{{ name }}</p>
        </div>
        <div class="field">
            <p id="campaignDescription">{{ description }}</p>
        </div>
    </div>

    <div class="customFields">
        {% for f in fields %}
        <div class="field">
            <input type="{{ f.type }}" data-type="{{ f.type }}" name="{{ f.fieldName }}" value="" placeholder="{{ f.name }}" />
        </div>
        {% endfor %}
    </div>

    <div class="field buttons">
        <button id="createForm" type="submit">Submit</button>
    </div>
</form>
<script type="text/javascript" src="/js/jquery.maskedinput.min.js"></script>
<script type="text/javascript" src="/js/create.js"></script>
{% endif %}

{% endblock %}
